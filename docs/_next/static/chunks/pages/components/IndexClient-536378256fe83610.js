(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[642,659],{3443:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/IndexClient",function(){return n(2659)}])},2659:function(e,t,n){"use strict";n.r(t);var i=n(5893),a=n(7294),l=n(1664),r=n.n(l),o=n(1163),d=n(1943);t.default=()=>{let{basePath:e}=(0,o.useRouter)(),t=t=>{let n=t.startsWith("/")?t:"/".concat(t);return"".concat(null!=e?e:"").concat(n)},[n,l]=(0,a.useState)(!1),[s,u]=(0,a.useState)(""),[c,f]=(0,a.useState)(""),[h,m]=(0,a.useState)(!1),g=(0,a.useRef)(null),v=(0,a.useRef)(null),w=(0,a.useRef)(null),x=(0,a.useRef)(null),[p,y]=(0,a.useState)(null),S=(0,a.useMemo)(()=>({to:{weight:400,manualSize:60,xOffset:-80,yOffset:5},from:{weight:400,manualSize:60,xOffset:135,yOffset:5}}),[]),b=(0,a.useMemo)(()=>({to:{weight:400,manualSize:60,xOffset:-80,yOffset:5},from:{weight:400,manualSize:60,xOffset:135,yOffset:5}}),[]),z=(0,a.useCallback)(()=>{var e;let t=x.current,n=w.current,i=null!==(e=null==t?void 0:t.clientWidth)&&void 0!==e?e:null==n?void 0:n.clientWidth;if(!i)return;let a=i/1024;y(e=>null===e?a:Math.abs(e-a)>.005?a:e)},[]);(0,a.useEffect)(()=>{z();let e=w.current;if(!e||"undefined"==typeof ResizeObserver)return;let t=new ResizeObserver(()=>z());return t.observe(e),()=>t.disconnect()},[z]),(0,a.useEffect)(()=>{let e=x.current;if(e){if(e.complete){z();return}return e.addEventListener("load",z),()=>e.removeEventListener("load",z)}},[z]),(0,a.useEffect)(()=>{var e,t;let n=!0;return(null===(t=document)||void 0===t?void 0:null===(e=t.fonts)||void 0===e?void 0:e.ready)&&document.fonts.ready.then(()=>{n&&z()}).catch(()=>{}),()=>{n=!1}},[z]);let O=(0,a.useMemo)(()=>{var e,t,n,i;if(!p)return;let a={},l=null!==(e=b.to.manualSize)&&void 0!==e?e:0,r=null!==(t=b.from.manualSize)&&void 0!==t?t:0,o=null!==(n=b.to.weight)&&void 0!==n?n:400,d=null!==(i=b.from.weight)&&void 0!==i?i:400;if(l>0){let e=p*l;a["--landing-to-font-size"]="".concat(Math.round(e),"px"),a["--landing-to-line-height"]="".concat(Math.round(1.08*e),"px")}if(r>0){let e=p*r;a["--landing-from-font-size"]="".concat(Math.round(e),"px"),a["--landing-from-line-height"]="".concat(Math.round(1.08*e),"px")}return a["--landing-to-font-weight"]="".concat(o),a["--landing-from-font-weight"]="".concat(d),a},[p,S]),j=async()=>{if(h)return;let e=g.current;if(!e){window.alert("초대장 미리보기가 준비되지 않았습니다.");return}let t=s.trim(),n=c.trim();if(0===e.width||0===e.height){window.alert("초대장 미리보기를 불러오는 중입니다. 잠시 후 다시 시도해 주세요.");return}m(!0);try{let l;if(!v.current)throw Error("다운로드 링크가 준비되지 않았습니다.");let r="invitation-from-".concat(encodeURIComponent(n||"unknown"),"-to-").concat(encodeURIComponent(t||"guest"),".png"),o=null,d=null;if(e.toBlob&&(o=await new Promise(t=>e.toBlob(t,"image/png"))),!o){let t=e.toDataURL("image/png");d=t;let n=t.indexOf(","),i=n>-1?t.slice(5,t.indexOf(";")):"image/png",a=atob(n>-1?t.slice(n+1):t),l=new ArrayBuffer(a.length),r=new Uint8Array(l);for(let e=0;e<a.length;e+=1)r[e]=a.charCodeAt(e);o=new Blob([r],{type:i})}if(!o)throw Error("초대장 이미지를 생성하지 못했습니다.");let s="undefined"!=typeof navigator?navigator:void 0,u="undefined"!=typeof navigator?navigator.userAgent:"",c=/iP(ad|hone|od)/i.test(u),f=c&&/Safari/i.test(u)&&!/CriOS|FxiOS|EdgiOS/i.test(u),h=!c&&/Safari/i.test(u)&&!/Chrome|CriOS|Edg|OPR/i.test(u),m=/Android/i.test(u),g={title:n?"".concat(n,"의 초대장"):"초대장",text:t?"".concat(t," 님께 전달하는 초대장입니다."):"초대장을 함께 확인해 주세요."};if("undefined"!=typeof File)try{g.files=[new File([o],r,{type:"image/png"})]}catch(e){}let w=!!(null==s?void 0:s.share),x=(()=>{var e;if(!w||!s||!(null===(e=g.files)||void 0===e?void 0:e.length))return!1;if("function"!=typeof s.canShare)return!0;try{return s.canShare({files:g.files})}catch(e){return!1}})(),p=w&&(c||m||f||h),y=async e=>{if(!(null==s?void 0:s.share))return!1;try{return await s.share(e),!0}catch(e){return console.warn("초대장 공유에 실패했습니다.",e),!1}},S=!1;if(p&&(null==s?void 0:s.share)&&(g.files&&x&&(S=await y(g)),!S)){var i,a;let e={title:g.title,text:null!==(a=null!==(i=g.text)&&void 0!==i?i:g.title)&&void 0!==a?a:"초대장을 함께 확인해 주세요."};S=await y(e)}let b=d;if(!b){let e=URL.createObjectURL(o);b=e,l=()=>URL.revokeObjectURL(e)}if(S){null==l||l();return}!((e,t)=>{let n=v.current,i=(()=>{if("undefined"==typeof document)return!1;let e=document.createElement("a");return"download"in e})(),a="undefined"!=typeof navigator&&/iP(ad|hone|od)/i.test(navigator.userAgent);if(!a&&i&&n)return n.href=e,n.download=r,n.click(),n.removeAttribute("download"),n.removeAttribute("href"),null==t||t(),!0;let l=document.createElement("a");return l.href=e,l.download=r,l.style.display="none",document.body.appendChild(l),l.click(),document.body.removeChild(l),t&&window.setTimeout(t,1500),!a})(b,l)&&p&&(null==s?void 0:s.share)&&await y(g)}catch(e){console.error(e),window.alert("초대장을 저장하지 못했습니다. 다시 시도해 주세요.")}finally{m(!1)}};return(0,i.jsx)("main",{className:"landing",children:(0,i.jsxs)("div",{className:"landing-wrapper",ref:w,children:[(0,i.jsx)("img",{src:t("/invitation.png"),alt:"졸업전시 초대장 미리보기 이미지",className:"landing-image-only",ref:x,onLoad:z}),(0,i.jsx)("div",{className:"landing-overlay".concat(n?" landing-overlay--readonly":""),style:n?void 0:O,children:n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"landing-result-card","aria-live":"polite","aria-label":"완성된 초대장 미리보기",children:(0,i.jsx)(d.default,{from:c,to:s,canvasRef:g,className:"landing-result-canvas",imageSrc:"/invitation_2.png",fontOptions:S})}),(0,i.jsxs)("div",{className:"landing-result-actions",children:[(0,i.jsx)("button",{type:"button",className:"landing-result-action",onClick:j,disabled:h,"aria-label":h?"초대장 저장 중":"초대장 저장하기",children:(0,i.jsx)("img",{src:t("/save.svg"),alt:""})}),(0,i.jsx)("button",{type:"button",className:"landing-result-action landing-result-action--retry",onClick:()=>{m(!1),l(!1),u(""),f("")},"aria-label":"이름 다시 입력하기",children:(0,i.jsx)("img",{src:t("/retry.svg"),alt:""})})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("label",{className:"landing-field landing-field--to",htmlFor:"landing-to-input",children:[!s&&(0,i.jsx)("img",{src:t("/write.png"),alt:"",className:"landing-placeholder landing-placeholder--to"}),(0,i.jsx)("input",{id:"landing-to-input",className:"landing-input","aria-label":"초대장을 받는 분",maxLength:20,value:s,onChange:e=>u(e.target.value)})]}),(0,i.jsxs)("label",{className:"landing-field landing-field--from",htmlFor:"landing-from-input",children:[!c&&(0,i.jsx)("img",{src:t("/write.png"),alt:"",className:"landing-placeholder landing-placeholder--from"}),(0,i.jsx)("input",{id:"landing-from-input",className:"landing-input","aria-label":"초대장을 보내는 분",maxLength:20,value:c,onChange:e=>f(e.target.value)})]})]})}),!n&&(0,i.jsx)(r(),{href:"/generator",className:"landing-button",prefetch:!1,"aria-label":"초대장 만들기 페이지로 이동",onClick:e=>{n||(e.preventDefault(),l(!0))},children:(0,i.jsx)("img",{src:t("/button_1.svg"),alt:"초대장 만들기 이동 버튼"})}),(0,i.jsx)("a",{ref:v,style:{display:"none"},"aria-hidden":"true"})]})})}},1943:function(e,t,n){"use strict";n.r(t);var i=n(5893),a=n(7294),l=n(1163);let r='"rixdongnimgothic-pro","tk-rixdongnimgothic-pro",sans-serif',o={weight:700,minSize:48,maxSize:900,targetWidthRatio:.92,manualSize:0,xOffset:-110,yOffset:0},d={weight:700,minSize:48,maxSize:820,targetWidthRatio:.92,manualSize:0,xOffset:145,yOffset:0};t.default=e=>{let{from:t,to:n,canvasRef:s,className:u,imageSrc:c="/invitation_2.svg",fontOptions:f}=e,{basePath:h}=(0,l.useRouter)(),m=(0,a.useCallback)(e=>{let t=e.startsWith("/")?e:"/".concat(e);return"".concat(null!=h?h:"").concat(t)},[h]),g=(0,a.useMemo)(()=>({to:{...o,...null==f?void 0:f.to},from:{...d,...null==f?void 0:f.from}}),[f]),[v,w]=(0,a.useState)(!1),[x,p]=(0,a.useState)(null),[y,S]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=!0;w(!1),p(null);let t=new Image;return t.crossOrigin="anonymous",t.onload=()=>{e&&(S(t),p(null))},t.onerror=()=>{e&&(S(null),w(!1),p("초대장 이미지를 불러오지 못했습니다."))},(async()=>{var e;if(document.fonts&&"ready"in document.fonts)try{await document.fonts.ready}catch(e){}if(null===(e=document.fonts)||void 0===e?void 0:e.load)try{let e=Array.from(new Set([g.to.weight,g.from.weight]));await Promise.all(e.flatMap(e=>[document.fonts.load("".concat(e," ").concat(36,"px rixdongnimgothic-pro")),document.fonts.load("".concat(e," ").concat(36,"px 'rixdongnimgothic-pro'")),document.fonts.load("".concat(e," ").concat(36,"px 'tk-rixdongnimgothic-pro'"))]))}catch(e){}})().finally(()=>{t.src=m(c)}),()=>{e=!1}},[m,c,g]),(0,a.useEffect)(()=>{let e=s.current,i=null==e?void 0:e.getContext("2d");if(!e||!i||!y)return;let a=()=>{let a=(t,n,a,l)=>{var o,d;let s=t.trim();if(!s)return;let u=(null!==(o=l.yOffset)&&void 0!==o?o:0)*(e.height/1098),c=Math.round(e.height*n+u),f=Math.min(.98*e.width,e.width*l.targetWidthRatio),h=(e,t)=>{i.font="".concat(t," ").concat(e,"px ").concat(r);let n=i.measureText(s);return n.actualBoundingBoxRight-n.actualBoundingBoxLeft||n.width},m=l.manualSize>0?Math.max(l.minSize,Math.min(l.maxSize,Math.round(l.manualSize*(e.width/1024)))):l.minSize;if(l.manualSize<=0){let e=l.minSize,t=Math.max(l.minSize,l.maxSize),n=l.minSize;for(;e<=t;){let i=Math.floor((e+t)/2);h(i,l.weight)<=f?(n=i,e=i+2):t=i-2}m=Math.min(n,l.maxSize)}i.font="".concat(l.weight," ").concat(m,"px ").concat(r),i.textAlign="center",i.textBaseline="middle",i.fillStyle="#121212";let g=null!==(d=l.xOffset)&&void 0!==d?d:a,v=Math.round(e.width/768*g),w=e.width/2+v;i.fillText(s,w,c)};i.imageSmoothingEnabled=!0,void 0!==i.imageSmoothingQuality&&(i.imageSmoothingQuality="high"),i.drawImage(y,0,0,e.width,e.height),a(n,.12021857923497267,0,g.to),a(t,.5591985428051002,0,g.from)},l=null,o=()=>{let t=e.getBoundingClientRect(),n=Math.max(1,window.devicePixelRatio||1),l=t.width||y.width,r=Math.max(768,Math.min(y.naturalWidth&&Number.isFinite(y.naturalWidth)?Math.max(768,Math.min(3072,y.naturalWidth)):3072,Math.round(l*n*3)||768)),o=Math.max(1,Math.round(r*(y.naturalHeight&&y.naturalWidth?y.naturalHeight/y.naturalWidth:1.4296875)));(e.width!==r||e.height!==o)&&(e.width=r,e.height=o);let d=t.width||r/n,s=o/r*d;e.style.width="".concat(d,"px"),e.style.height="".concat(s,"px"),i.clearRect(0,0,e.width,e.height),a(),w(!0),p(null)};o();let d="undefined"!=typeof ResizeObserver?new ResizeObserver(()=>{l&&cancelAnimationFrame(l),l=window.requestAnimationFrame(o)}):null;null==d||d.observe(e);let u=()=>{l&&cancelAnimationFrame(l),l=window.requestAnimationFrame(o)};return window.addEventListener("resize",u),()=>{null==d||d.disconnect(),l&&cancelAnimationFrame(l),window.removeEventListener("resize",u)}},[s,t,n,y,g]),(0,i.jsxs)("div",{className:"invitation-wrapper",children:[!v&&(0,i.jsx)("div",{className:"canvas-status",children:null!=x?x:"초대장 이미지를 불러오는 중입니다..."}),(0,i.jsx)("canvas",{ref:s,className:null!=u?u:"invitation-canvas"})]})}}},function(e){e.O(0,[424,888,774,179],function(){return e(e.s=3443)}),_N_E=e.O()}]);