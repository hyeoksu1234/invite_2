(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[21],{1321:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/DownloadButton",function(){return n(7557)}])},2588:function(t,e,n){"use strict";n.d(e,{u:function(){return i}});let i=t=>{if(!t.width||!t.height)return null;let e=t.getBoundingClientRect(),n=e.width,i=e.height;if(!n||!i||1>Math.abs(n-t.width))return t;let o=n/t.width,r=i/t.height,l=document.createElement("canvas");l.width=Math.max(1,Math.round(t.width*o)),l.height=Math.max(1,Math.round(t.height*r));let a=l.getContext("2d");return a?(a.imageSmoothingEnabled=!0,a.imageSmoothingQuality="high",a.drawImage(t,0,0,t.width,t.height,0,0,l.width,l.height),l):null}},7557:function(t,e,n){"use strict";n.r(e);var i=n(5893),o=n(7294),r=n(2588);e.default=t=>{let{from:e,to:n,canvasRef:l,onReset:a}=t,[u,d]=(0,o.useState)(!1),c=(0,o.useRef)(null),h=async()=>{var t,i,o;let a=l.current;if(!a)return;d(!0);let u=e.trim(),h=n.trim(),s="invitation-from-".concat(encodeURIComponent(u||"unknown"),"-to-").concat(encodeURIComponent(h||"guest"),".png"),f=null!==(t=(0,r.u)(a))&&void 0!==t?t:a;try{let t,e=null,n=null;if(f.toBlob&&(e=await new Promise(t=>f.toBlob(t,"image/png"))),!e){let t=f.toDataURL("image/png");n=t;let i=t.indexOf(","),o=i>-1?t.slice(5,t.indexOf(";")):"image/png",r=atob(i>-1?t.slice(i+1):t),l=new ArrayBuffer(r.length),a=new Uint8Array(l);for(let t=0;t<r.length;t+=1)a[t]=r.charCodeAt(t);e=new Blob([a],{type:o})}if(!e)throw Error("초대장 이미지를 생성하지 못했습니다.");let r="undefined"!=typeof navigator?navigator:void 0,l="undefined"!=typeof navigator?navigator.userAgent:"",a=/iP(ad|hone|od)/i.test(l),d=/Android/i.test(l),w={title:u?"".concat(u,"의 초대장"):"초대장",text:h?"".concat(h," 님께 전달하는 초대장입니다."):"초대장을 함께 확인해 주세요."};if("undefined"!=typeof File)try{w.files=[new File([e],s,{type:"image/png"})]}catch(t){}let g=!!(null==r?void 0:r.share),m=(()=>{var t;if(!g||!r||!(null===(t=w.files)||void 0===t?void 0:t.length))return!1;if("function"!=typeof r.canShare)return!0;try{return r.canShare({files:w.files})}catch(t){return!1}})(),b=async t=>{if(!(null==r?void 0:r.share))return!1;try{return await r.share(t),!0}catch(t){return console.warn("초대장 공유에 실패했습니다.",t),!1}},p=!1;if(g&&(a||d)&&(null==r?void 0:r.share)&&(w.files&&m&&(p=await b(w)),!p)){let t={title:w.title,text:null!==(o=null!==(i=w.text)&&void 0!==i?i:w.title)&&void 0!==o?o:"초대장을 함께 확인해 주세요."};p=await b(t)}let v=n;if(!v){let n=URL.createObjectURL(e);v=n,t=()=>URL.revokeObjectURL(n)}if(p){null==t||t();return}((t,e)=>{let n=c.current,i=null!=n?n:document.createElement("a"),o=!n;i.href=t,i.download=s,o&&(i.style.display="none",document.body.appendChild(i)),i.click(),window.requestAnimationFrame(()=>{i.removeAttribute("href"),i.removeAttribute("download"),null==e||e(),o&&i.remove()})})(v,t)}catch(t){console.error(t),window.alert("초대장을 저장하지 못했습니다. 다시 시도해 주세요.")}finally{d(!1)}};return(0,i.jsxs)("div",{className:"download-actions",children:[(0,i.jsx)("button",{className:"btn btn-save".concat(u?" btn-disabled":""),type:"button",disabled:u,onClick:h,children:u?"저장 중...":"저장하기"}),(0,i.jsx)("button",{className:"btn btn-retry",type:"button",onClick:()=>{d(!1),a()},children:"다시하기"}),(0,i.jsx)("a",{ref:c,style:{display:"none"}})]})}}},function(t){t.O(0,[888,774,179],function(){return t(t.s=1321)}),_N_E=t.O()}]);