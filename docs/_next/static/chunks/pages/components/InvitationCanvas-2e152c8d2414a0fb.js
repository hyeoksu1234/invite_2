(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[776],{732:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/InvitationCanvas",function(){return e(1943)}])},1943:function(t,n,e){"use strict";e.r(n);var i=e(5893),a=e(7294),o=e(1163);let l='"rixdongnimgothic-pro","tk-rixdongnimgothic-pro",sans-serif',r={weight:700,minSize:48,maxSize:900,targetWidthRatio:.92,manualSize:0},c={weight:700,minSize:48,maxSize:820,targetWidthRatio:.92,manualSize:0};n.default=t=>{let{from:n,to:e,canvasRef:u,className:h,imageSrc:d="/invitation_2.svg",fontOptions:m}=t,{basePath:s}=(0,o.useRouter)(),g=(0,a.useCallback)(t=>{let n=t.startsWith("/")?t:"/".concat(t);return"".concat(null!=s?s:"").concat(n)},[s]),f=(0,a.useMemo)(()=>({to:{...r,...null==m?void 0:m.to},from:{...c,...null==m?void 0:m.from}}),[m]),[w,x]=(0,a.useState)(!1),[v,S]=(0,a.useState)(null),[p,z]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let t=!0;x(!1),S(null);let n=new Image;return n.crossOrigin="anonymous",n.onload=()=>{t&&(z(n),S(null))},n.onerror=()=>{t&&(z(null),x(!1),S("초대장 이미지를 불러오지 못했습니다."))},(async()=>{var t;if(document.fonts&&"ready"in document.fonts)try{await document.fonts.ready}catch(t){}if(null===(t=document.fonts)||void 0===t?void 0:t.load)try{let t=Array.from(new Set([f.to.weight,f.from.weight]));await Promise.all(t.flatMap(t=>[document.fonts.load("".concat(t," ").concat(36,"px rixdongnimgothic-pro")),document.fonts.load("".concat(t," ").concat(36,"px 'rixdongnimgothic-pro'")),document.fonts.load("".concat(t," ").concat(36,"px 'tk-rixdongnimgothic-pro'"))]))}catch(t){}})().finally(()=>{n.src=g(d)}),()=>{t=!1}},[g,d,f]),(0,a.useEffect)(()=>{let t=u.current,i=null==t?void 0:t.getContext("2d");if(!t||!i||!p)return;let a=()=>{let a=(n,e,a,o)=>{let r=n.trim();if(!r)return;let c=Math.round(t.height*e),u=Math.min(.98*t.width,t.width*o.targetWidthRatio),h=(t,n)=>{i.font="".concat(n," ").concat(t,"px ").concat(l);let e=i.measureText(r);return e.actualBoundingBoxRight-e.actualBoundingBoxLeft||e.width},d=o.manualSize>0?Math.max(o.minSize,Math.min(o.maxSize,Math.round(o.manualSize*(t.width/1024)))):o.minSize;if(o.manualSize<=0){let t=o.minSize,n=Math.max(o.minSize,o.maxSize),e=o.minSize;for(;t<=n;){let i=Math.floor((t+n)/2);h(i,o.weight)<=u?(e=i,t=i+2):n=i-2}d=Math.min(e,o.maxSize)}i.font="".concat(o.weight," ").concat(d,"px ").concat(l),i.textAlign="center",i.textBaseline="middle",i.fillStyle="#121212";let m=t.width/2+a;i.fillText(r,m,c)};i.imageSmoothingEnabled=!0,void 0!==i.imageSmoothingQuality&&(i.imageSmoothingQuality="high"),i.drawImage(p,0,0,t.width,t.height),a(e,.12021857923497267,-90,f.to),a(n,.5591985428051002,125,f.from)},o=null,r=()=>{let n=t.getBoundingClientRect(),e=Math.max(1,window.devicePixelRatio||1),o=n.width||p.width,l=Math.max(768,Math.min(p.naturalWidth&&Number.isFinite(p.naturalWidth)?Math.max(768,Math.min(2304,p.naturalWidth)):2304,Math.round(o*e*2)||768)),r=Math.max(1,Math.round(l*(p.naturalHeight&&p.naturalWidth?p.naturalHeight/p.naturalWidth:1.4296875)));(t.width!==l||t.height!==r)&&(t.width=l,t.height=r);let c=n.width||l/e,u=r/l*c;t.style.width="".concat(c,"px"),t.style.height="".concat(u,"px"),i.clearRect(0,0,t.width,t.height),a(),x(!0),S(null)};r();let c="undefined"!=typeof ResizeObserver?new ResizeObserver(()=>{o&&cancelAnimationFrame(o),o=window.requestAnimationFrame(r)}):null;null==c||c.observe(t);let h=()=>{o&&cancelAnimationFrame(o),o=window.requestAnimationFrame(r)};return window.addEventListener("resize",h),()=>{null==c||c.disconnect(),o&&cancelAnimationFrame(o),window.removeEventListener("resize",h)}},[u,n,e,p,f]),(0,i.jsxs)("div",{className:"invitation-wrapper",children:[!w&&(0,i.jsx)("div",{className:"canvas-status",children:null!=v?v:"초대장 이미지를 불러오는 중입니다..."}),(0,i.jsx)("canvas",{ref:u,className:null!=h?h:"invitation-canvas"})]})}},1163:function(t,n,e){t.exports=e(3079)}},function(t){t.O(0,[888,774,179],function(){return t(t.s=732)}),_N_E=t.O()}]);