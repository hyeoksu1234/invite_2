(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[776],{732:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/InvitationCanvas",function(){return e(1943)}])},1943:function(t,n,e){"use strict";e.r(n);var i=e(5893),a=e(7294),o=e(1163);let l='"rixdongnimgothic-pro","tk-rixdongnimgothic-pro",sans-serif',r={weight:700,minSize:48,maxSize:900,targetWidthRatio:.92,manualSize:0},c={weight:700,minSize:48,maxSize:820,targetWidthRatio:.92,manualSize:0};n.default=t=>{let{from:n,to:e,canvasRef:u,className:d,imageSrc:s="/invitation_2.svg",fontOptions:h}=t,{basePath:m}=(0,o.useRouter)(),f=(0,a.useCallback)(t=>{let n=t.startsWith("/")?t:"/".concat(t);return"".concat(null!=m?m:"").concat(n)},[m]),w=(0,a.useMemo)(()=>({to:{...r,...null==h?void 0:h.to},from:{...c,...null==h?void 0:h.from}}),[h]),[g,x]=(0,a.useState)(!1),[v,p]=(0,a.useState)(null),[S,z]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let t=!0;x(!1),p(null);let n=new Image;return n.crossOrigin="anonymous",n.onload=()=>{t&&(z(n),p(null))},n.onerror=()=>{t&&(z(null),x(!1),p("초대장 이미지를 불러오지 못했습니다."))},(async()=>{var t;if(document.fonts&&"ready"in document.fonts)try{await document.fonts.ready}catch(t){}if(null===(t=document.fonts)||void 0===t?void 0:t.load)try{let t=Array.from(new Set([w.to.weight,w.from.weight]));await Promise.all(t.flatMap(t=>[document.fonts.load("".concat(t," ").concat(36,"px rixdongnimgothic-pro")),document.fonts.load("".concat(t," ").concat(36,"px 'rixdongnimgothic-pro'")),document.fonts.load("".concat(t," ").concat(36,"px 'tk-rixdongnimgothic-pro'"))]))}catch(t){}})().finally(()=>{n.src=f(s)}),()=>{t=!1}},[f,s,w]),(0,a.useEffect)(()=>{let t=u.current,i=null==t?void 0:t.getContext("2d");if(!t||!i||!S)return;let a=()=>{let a=(n,e,a,o)=>{let r=n.trim();if(!r)return;let c=Math.round(t.height*e),u=Math.min(.98*t.width,t.width*o.targetWidthRatio),d=(t,n)=>{i.font="".concat(n," ").concat(t,"px ").concat(l);let e=i.measureText(r);return e.actualBoundingBoxRight-e.actualBoundingBoxLeft||e.width},s=o.manualSize>0?Math.max(o.minSize,Math.min(o.maxSize,Math.round(o.manualSize*(t.width/1024)))):o.minSize;if(o.manualSize<=0){let t=o.minSize,n=Math.max(o.minSize,o.maxSize),e=o.minSize;for(;t<=n;){let i=Math.floor((t+n)/2);d(i,o.weight)<=u?(e=i,t=i+2):n=i-2}s=Math.min(e,o.maxSize)}i.font="".concat(o.weight," ").concat(s,"px ").concat(l),i.textAlign="center",i.textBaseline="middle",i.fillStyle="#121212";let h=t.width/2+a;i.fillText(r,h,c)};i.drawImage(S,0,0,t.width,t.height),a(e,.12021857923497267,-90,w.to),a(n,.5591985428051002,110,w.from)},o=null,r=()=>{let n=t.getBoundingClientRect(),e=Math.max(1,window.devicePixelRatio||1),o=Math.max(768,Math.min(2304,Math.round((n.width||S.width)*e)||768)),l=Math.max(1,Math.round(o*(S.naturalHeight&&S.naturalWidth?S.naturalHeight/S.naturalWidth:1.4296875)));(t.width!==o||t.height!==l)&&(t.width=o,t.height=l);let r=n.width||o/e,c=l/o*r;t.style.width="".concat(r,"px"),t.style.height="".concat(c,"px"),i.clearRect(0,0,t.width,t.height),a(),x(!0),p(null)};r();let c="undefined"!=typeof ResizeObserver?new ResizeObserver(()=>{o&&cancelAnimationFrame(o),o=window.requestAnimationFrame(r)}):null;null==c||c.observe(t);let d=()=>{o&&cancelAnimationFrame(o),o=window.requestAnimationFrame(r)};return window.addEventListener("resize",d),()=>{null==c||c.disconnect(),o&&cancelAnimationFrame(o),window.removeEventListener("resize",d)}},[u,n,e,S,w]),(0,i.jsxs)("div",{className:"invitation-wrapper",children:[!g&&(0,i.jsx)("div",{className:"canvas-status",children:null!=v?v:"초대장 이미지를 불러오는 중입니다..."}),(0,i.jsx)("canvas",{ref:u,className:null!=d?d:"invitation-canvas"})]})}},1163:function(t,n,e){t.exports=e(3079)}},function(t){t.O(0,[888,774,179],function(){return t(t.s=732)}),_N_E=t.O()}]);