(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[776],{732:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/InvitationCanvas",function(){return n(1943)}])},1943:function(t,e,n){"use strict";n.r(e);var i=n(5893),a=n(7294),o=n(1163);let l='"rixdongnimgothic-pro","tk-rixdongnimgothic-pro",sans-serif',r={weight:700,minSize:48,maxSize:900,targetWidthRatio:.92,manualSize:0,xOffset:-110,yOffset:0},c={weight:700,minSize:48,maxSize:820,targetWidthRatio:.92,manualSize:0,xOffset:145,yOffset:0};e.default=t=>{let{from:e,to:n,canvasRef:u,className:h,imageSrc:d="/invitation_2.svg",fontOptions:m}=t,{basePath:s}=(0,o.useRouter)(),f=(0,a.useCallback)(t=>{let e=t.startsWith("/")?t:"/".concat(t);return"".concat(null!=s?s:"").concat(e)},[s]),g=(0,a.useMemo)(()=>({to:{...r,...null==m?void 0:m.to},from:{...c,...null==m?void 0:m.from}}),[m]),[w,x]=(0,a.useState)(!1),[v,S]=(0,a.useState)(null),[p,z]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let t=!0;x(!1),S(null);let e=new Image;return e.crossOrigin="anonymous",e.onload=()=>{t&&(z(e),S(null))},e.onerror=()=>{t&&(z(null),x(!1),S("초대장 이미지를 불러오지 못했습니다."))},(async()=>{var t;if(document.fonts&&"ready"in document.fonts)try{await document.fonts.ready}catch(t){}if(null===(t=document.fonts)||void 0===t?void 0:t.load)try{let t=Array.from(new Set([g.to.weight,g.from.weight]));await Promise.all(t.flatMap(t=>[document.fonts.load("".concat(t," ").concat(36,"px rixdongnimgothic-pro")),document.fonts.load("".concat(t," ").concat(36,"px 'rixdongnimgothic-pro'")),document.fonts.load("".concat(t," ").concat(36,"px 'tk-rixdongnimgothic-pro'"))]))}catch(t){}})().finally(()=>{e.src=f(d)}),()=>{t=!1}},[f,d,g]),(0,a.useEffect)(()=>{let t=u.current,i=null==t?void 0:t.getContext("2d");if(!t||!i||!p)return;let a=()=>{let a=(e,n,a,o)=>{var r,c;let u=e.trim();if(!u)return;let h=(null!==(r=o.yOffset)&&void 0!==r?r:0)*(t.height/1098),d=Math.round(t.height*n+h),m=Math.min(.98*t.width,t.width*o.targetWidthRatio),s=(t,e)=>{i.font="".concat(e," ").concat(t,"px ").concat(l);let n=i.measureText(u);return n.actualBoundingBoxRight-n.actualBoundingBoxLeft||n.width},f=o.manualSize>0?Math.max(o.minSize,Math.min(o.maxSize,Math.round(o.manualSize*(t.width/1024)))):o.minSize;if(o.manualSize<=0){let t=o.minSize,e=Math.max(o.minSize,o.maxSize),n=o.minSize;for(;t<=e;){let i=Math.floor((t+e)/2);s(i,o.weight)<=m?(n=i,t=i+2):e=i-2}f=Math.min(n,o.maxSize)}i.font="".concat(o.weight," ").concat(f,"px ").concat(l),i.textAlign="center",i.textBaseline="middle",i.fillStyle="#121212";let g=null!==(c=o.xOffset)&&void 0!==c?c:a,w=Math.round(t.width/768*g),x=t.width/2+w;i.fillText(u,x,d)};i.imageSmoothingEnabled=!0,void 0!==i.imageSmoothingQuality&&(i.imageSmoothingQuality="high"),i.drawImage(p,0,0,t.width,t.height),a(n,.12021857923497267,0,g.to),a(e,.5591985428051002,0,g.from)},o=null,r=()=>{let e=t.getBoundingClientRect(),n=Math.max(1,window.devicePixelRatio||1),o=e.width||p.width,l=Math.max(768,Math.min(p.naturalWidth&&Number.isFinite(p.naturalWidth)?Math.max(768,Math.min(3072,p.naturalWidth)):3072,Math.round(o*n*3)||768)),r=Math.max(1,Math.round(l*(p.naturalHeight&&p.naturalWidth?p.naturalHeight/p.naturalWidth:1.4296875)));(t.width!==l||t.height!==r)&&(t.width=l,t.height=r);let c=e.width||l/n,u=r/l*c;t.style.width="".concat(c,"px"),t.style.height="".concat(u,"px"),i.clearRect(0,0,t.width,t.height),a(),x(!0),S(null)};r();let c="undefined"!=typeof ResizeObserver?new ResizeObserver(()=>{o&&cancelAnimationFrame(o),o=window.requestAnimationFrame(r)}):null;null==c||c.observe(t);let h=()=>{o&&cancelAnimationFrame(o),o=window.requestAnimationFrame(r)};return window.addEventListener("resize",h),()=>{null==c||c.disconnect(),o&&cancelAnimationFrame(o),window.removeEventListener("resize",h)}},[u,e,n,p,g]),(0,i.jsxs)("div",{className:"invitation-wrapper",children:[!w&&(0,i.jsx)("div",{className:"canvas-status",children:null!=v?v:"초대장 이미지를 불러오는 중입니다..."}),(0,i.jsx)("canvas",{ref:u,className:null!=h?h:"invitation-canvas"})]})}},1163:function(t,e,n){t.exports=n(3079)}},function(t){t.O(0,[888,774,179],function(){return t(t.s=732)}),_N_E=t.O()}]);