(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[642,659],{3443:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/IndexClient",function(){return n(2659)}])},2588:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});let i=e=>{if(!e.width||!e.height)return null;let t=e.getBoundingClientRect(),n=t.width,i=t.height;if(!n||!i||1>Math.abs(n-e.width))return e;let a=n/e.width,l=i/e.height,r=document.createElement("canvas");r.width=Math.max(1,Math.round(e.width*a)),r.height=Math.max(1,Math.round(e.height*l));let o=r.getContext("2d");return o?(o.imageSmoothingEnabled=!0,o.imageSmoothingQuality="high",o.drawImage(e,0,0,e.width,e.height,0,0,r.width,r.height),r):null}},2659:function(e,t,n){"use strict";n.r(t);var i=n(5893),a=n(7294),l=n(1664),r=n.n(l),o=n(1163),d=n(1943),u=n(2588);t.default=()=>{let{basePath:e}=(0,o.useRouter)(),t=t=>{let n=t.startsWith("/")?t:"/".concat(t);return"".concat(null!=e?e:"").concat(n)},[n,l]=(0,a.useState)(!1),[c,s]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[g,f]=(0,a.useState)(!1),w=(0,a.useRef)(null),v=(0,a.useRef)(null),x=(0,a.useRef)(null),p=(0,a.useRef)(null),[y,S]=(0,a.useState)(null),b=(0,a.useMemo)(()=>({to:{weight:400,manualSize:60},from:{weight:400,manualSize:60}}),[]),z=(0,a.useMemo)(()=>({to:{weight:400,manualSize:60},from:{weight:400,manualSize:60}}),[]),M=(0,a.useCallback)(()=>{var e;let t=p.current,n=x.current,i=null!==(e=null==t?void 0:t.clientWidth)&&void 0!==e?e:null==n?void 0:n.clientWidth;if(!i)return;let a=i/1024;S(e=>null===e?a:Math.abs(e-a)>.005?a:e)},[]);(0,a.useEffect)(()=>{M();let e=x.current;if(!e||"undefined"==typeof ResizeObserver)return;let t=new ResizeObserver(()=>M());return t.observe(e),()=>t.disconnect()},[M]),(0,a.useEffect)(()=>{let e=p.current;if(e){if(e.complete){M();return}return e.addEventListener("load",M),()=>e.removeEventListener("load",M)}},[M]);let j=(0,a.useMemo)(()=>{var e,t,n,i;if(!y)return;let a={},l=null!==(e=z.to.manualSize)&&void 0!==e?e:0,r=null!==(t=z.from.manualSize)&&void 0!==t?t:0,o=null!==(n=z.to.weight)&&void 0!==n?n:400,d=null!==(i=z.from.weight)&&void 0!==i?i:400;if(l>0){let e=y*l;a["--landing-to-font-size"]="".concat(Math.round(e),"px"),a["--landing-to-line-height"]="".concat(Math.round(1.08*e),"px")}if(r>0){let e=y*r;a["--landing-from-font-size"]="".concat(Math.round(e),"px"),a["--landing-from-line-height"]="".concat(Math.round(1.08*e),"px")}return a["--landing-to-font-weight"]="".concat(o),a["--landing-from-font-weight"]="".concat(d),a},[y,b]),R=async()=>{var e,t,n;if(g)return;let i=w.current;if(!i){window.alert("초대장 미리보기가 준비되지 않았습니다.");return}let a=c.trim(),l=h.trim();if(0===i.width||0===i.height){window.alert("초대장 미리보기를 불러오는 중입니다. 잠시 후 다시 시도해 주세요.");return}let r=null!==(e=(0,u.u)(i))&&void 0!==e?e:i;f(!0);try{let e;if(!v.current)throw Error("다운로드 링크가 준비되지 않았습니다.");let i="invitation-from-".concat(encodeURIComponent(l||"unknown"),"-to-").concat(encodeURIComponent(a||"guest"),".png"),o=null,d=null;if(r.toBlob&&(o=await new Promise(e=>r.toBlob(e,"image/png"))),!o){let e=r.toDataURL("image/png");d=e;let t=e.indexOf(","),n=t>-1?e.slice(5,e.indexOf(";")):"image/png",i=atob(t>-1?e.slice(t+1):e),a=new ArrayBuffer(i.length),l=new Uint8Array(a);for(let e=0;e<i.length;e+=1)l[e]=i.charCodeAt(e);o=new Blob([l],{type:n})}if(!o)throw Error("초대장 이미지를 생성하지 못했습니다.");let u="undefined"!=typeof navigator?navigator:void 0,c="undefined"!=typeof navigator?navigator.userAgent:"",s=/iP(ad|hone|od)/i.test(c),h=s&&/Safari/i.test(c)&&!/CriOS|FxiOS|EdgiOS/i.test(c),m=!s&&/Safari/i.test(c)&&!/Chrome|CriOS|Edg|OPR/i.test(c),g=/Android/i.test(c),f={title:l?"".concat(l,"의 초대장"):"초대장",text:a?"".concat(a," 님께 전달하는 초대장입니다."):"초대장을 함께 확인해 주세요."};if("undefined"!=typeof File)try{f.files=[new File([o],i,{type:"image/png"})]}catch(e){}let w=!!(null==u?void 0:u.share),x=(()=>{var e;if(!w||!u||!(null===(e=f.files)||void 0===e?void 0:e.length))return!1;if("function"!=typeof u.canShare)return!0;try{return u.canShare({files:f.files})}catch(e){return!1}})(),p=w&&(s||g||h||m),y=async e=>{if(!(null==u?void 0:u.share))return!1;try{return await u.share(e),!0}catch(e){return console.warn("초대장 공유에 실패했습니다.",e),!1}},S=!1;if(p&&(null==u?void 0:u.share)&&(f.files&&x&&(S=await y(f)),!S)){let e={title:f.title,text:null!==(n=null!==(t=f.text)&&void 0!==t?t:f.title)&&void 0!==n?n:"초대장을 함께 확인해 주세요."};S=await y(e)}let b=d;if(!b){let t=URL.createObjectURL(o);b=t,e=()=>URL.revokeObjectURL(t)}if(S){null==e||e();return}!((e,t)=>{let n=v.current,a=(()=>{if("undefined"==typeof document)return!1;let e=document.createElement("a");return"download"in e})(),l="undefined"!=typeof navigator&&/iP(ad|hone|od)/i.test(navigator.userAgent);if(!l&&a&&n)return n.href=e,n.download=i,n.click(),n.removeAttribute("download"),n.removeAttribute("href"),null==t||t(),!0;let r=document.createElement("a");return r.href=e,r.download=i,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),t&&window.setTimeout(t,1500),!l})(b,e)&&p&&(null==u?void 0:u.share)&&await y(f)}catch(e){console.error(e),window.alert("초대장을 저장하지 못했습니다. 다시 시도해 주세요.")}finally{f(!1)}};return(0,i.jsx)("main",{className:"landing",children:(0,i.jsxs)("div",{className:"landing-wrapper",ref:x,children:[(0,i.jsx)("img",{src:t("/invitation.png"),alt:"졸업전시 초대장 미리보기 이미지",className:"landing-image-only",ref:p,onLoad:M}),(0,i.jsx)("div",{className:"landing-overlay".concat(n?" landing-overlay--readonly":""),style:n?void 0:j,children:n?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"landing-result-card","aria-live":"polite","aria-label":"완성된 초대장 미리보기",children:(0,i.jsx)(d.default,{from:h,to:c,canvasRef:w,className:"landing-result-canvas",imageSrc:"/invitation_2.svg",fontOptions:b})}),(0,i.jsxs)("div",{className:"landing-result-actions",children:[(0,i.jsx)("button",{type:"button",className:"landing-result-action",onClick:R,disabled:g,"aria-label":g?"초대장 저장 중":"초대장 저장하기",children:(0,i.jsx)("img",{src:t("/save.svg"),alt:""})}),(0,i.jsx)("button",{type:"button",className:"landing-result-action landing-result-action--retry",onClick:()=>{f(!1),l(!1),s(""),m("")},"aria-label":"이름 다시 입력하기",children:(0,i.jsx)("img",{src:t("/retry.svg"),alt:""})})]})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("label",{className:"landing-field landing-field--to",htmlFor:"landing-to-input",children:[!c&&(0,i.jsx)("img",{src:t("/write.png"),alt:"",className:"landing-placeholder landing-placeholder--to"}),(0,i.jsx)("input",{id:"landing-to-input",className:"landing-input","aria-label":"초대장을 받는 분",maxLength:20,value:c,onChange:e=>s(e.target.value)})]}),(0,i.jsxs)("label",{className:"landing-field landing-field--from",htmlFor:"landing-from-input",children:[!h&&(0,i.jsx)("img",{src:t("/write.png"),alt:"",className:"landing-placeholder landing-placeholder--from"}),(0,i.jsx)("input",{id:"landing-from-input",className:"landing-input","aria-label":"초대장을 보내는 분",maxLength:20,value:h,onChange:e=>m(e.target.value)})]})]})}),!n&&(0,i.jsx)(r(),{href:"/generator",className:"landing-button",prefetch:!1,"aria-label":"초대장 만들기 페이지로 이동",onClick:e=>{n||(e.preventDefault(),l(!0))},children:(0,i.jsx)("img",{src:t("/button_1.svg"),alt:"초대장 만들기 이동 버튼"})}),(0,i.jsx)("a",{ref:v,style:{display:"none"},"aria-hidden":"true"})]})})}},1943:function(e,t,n){"use strict";n.r(t);var i=n(5893),a=n(7294),l=n(1163);let r='"rixdongnimgothic-pro","tk-rixdongnimgothic-pro",sans-serif',o={weight:700,minSize:48,maxSize:900,targetWidthRatio:.92,manualSize:0},d={weight:700,minSize:48,maxSize:820,targetWidthRatio:.92,manualSize:0};t.default=e=>{let{from:t,to:n,canvasRef:u,className:c,imageSrc:s="/invitation_2.svg",fontOptions:h}=e,{basePath:m}=(0,l.useRouter)(),g=(0,a.useCallback)(e=>{let t=e.startsWith("/")?e:"/".concat(e);return"".concat(null!=m?m:"").concat(t)},[m]),f=(0,a.useMemo)(()=>({to:{...o,...null==h?void 0:h.to},from:{...d,...null==h?void 0:h.from}}),[h]),[w,v]=(0,a.useState)(!1),[x,p]=(0,a.useState)(null),[y,S]=(0,a.useState)(null);return(0,a.useEffect)(()=>{let e=!0;v(!1),p(null);let t=new Image;return t.crossOrigin="anonymous",t.onload=()=>{e&&(S(t),p(null))},t.onerror=()=>{e&&(S(null),v(!1),p("초대장 이미지를 불러오지 못했습니다."))},(async()=>{var e;if(document.fonts&&"ready"in document.fonts)try{await document.fonts.ready}catch(e){}if(null===(e=document.fonts)||void 0===e?void 0:e.load)try{let e=Array.from(new Set([f.to.weight,f.from.weight]));await Promise.all(e.flatMap(e=>[document.fonts.load("".concat(e," ").concat(36,"px rixdongnimgothic-pro")),document.fonts.load("".concat(e," ").concat(36,"px 'rixdongnimgothic-pro'")),document.fonts.load("".concat(e," ").concat(36,"px 'tk-rixdongnimgothic-pro'"))]))}catch(e){}})().finally(()=>{t.src=g(s)}),()=>{e=!1}},[g,s,f]),(0,a.useEffect)(()=>{let e=u.current,i=null==e?void 0:e.getContext("2d");if(!e||!i||!y)return;let a=()=>{let a=(t,n,a,l)=>{let o=t.trim();if(!o)return;let d=Math.round(e.height*n),u=Math.min(.98*e.width,e.width*l.targetWidthRatio),c=(e,t)=>{i.font="".concat(t," ").concat(e,"px ").concat(r);let n=i.measureText(o);return n.actualBoundingBoxRight-n.actualBoundingBoxLeft||n.width},s=l.manualSize>0?Math.max(l.minSize,Math.min(l.maxSize,Math.round(l.manualSize*(e.width/1024)))):l.minSize;if(l.manualSize<=0){let e=l.minSize,t=Math.max(l.minSize,l.maxSize),n=l.minSize;for(;e<=t;){let i=Math.floor((e+t)/2);c(i,l.weight)<=u?(n=i,e=i+2):t=i-2}s=Math.min(n,l.maxSize)}i.font="".concat(l.weight," ").concat(s,"px ").concat(r),i.textAlign="center",i.textBaseline="middle",i.fillStyle="#121212";let h=e.width/2+a;i.fillText(o,h,d)};i.drawImage(y,0,0,e.width,e.height),a(n,.12477231329690346,-69,f.to),a(t,.563752276867031,88,f.from)},l=null,o=()=>{let t=e.getBoundingClientRect(),n=Math.max(1,window.devicePixelRatio||1),l=Math.max(768,Math.min(2304,Math.round((t.width||y.width)*n)||768)),r=Math.max(1,Math.round(l*(y.naturalHeight&&y.naturalWidth?y.naturalHeight/y.naturalWidth:1.4296875)));(e.width!==l||e.height!==r)&&(e.width=l,e.height=r);let o=t.width||l/n,d=r/l*o;e.style.width="".concat(o,"px"),e.style.height="".concat(d,"px"),i.clearRect(0,0,e.width,e.height),a(),v(!0),p(null)};o();let d="undefined"!=typeof ResizeObserver?new ResizeObserver(()=>{l&&cancelAnimationFrame(l),l=window.requestAnimationFrame(o)}):null;null==d||d.observe(e);let c=()=>{l&&cancelAnimationFrame(l),l=window.requestAnimationFrame(o)};return window.addEventListener("resize",c),()=>{null==d||d.disconnect(),l&&cancelAnimationFrame(l),window.removeEventListener("resize",c)}},[u,t,n,y,f]),(0,i.jsxs)("div",{className:"invitation-wrapper",children:[!w&&(0,i.jsx)("div",{className:"canvas-status",children:null!=x?x:"초대장 이미지를 불러오는 중입니다..."}),(0,i.jsx)("canvas",{ref:u,className:null!=c?c:"invitation-canvas"})]})}}},function(e){e.O(0,[424,888,774,179],function(){return e(e.s=3443)}),_N_E=e.O()}]);