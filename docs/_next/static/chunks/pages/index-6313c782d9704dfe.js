(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(1854)}])},2588:function(e,t,n){"use strict";n.d(t,{u:function(){return a}});let a=e=>{if(!e.width||!e.height)return null;let t=document.createElement("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");return n?(n.imageSmoothingEnabled=!0,n.imageSmoothingQuality="high",n.drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),t):null}},1943:function(e,t,n){"use strict";n.r(t);var a=n(5893),i=n(7294),l=n(1163);let r='"rixdongnimgothic-pro","tk-rixdongnimgothic-pro",sans-serif';t.default=e=>{let{from:t,to:n,canvasRef:o,className:s,imageSrc:d="/invitation_2.svg"}=e,{basePath:c}=(0,l.useRouter)(),u=(0,i.useCallback)(e=>{let t=e.startsWith("/")?e:"/".concat(e);return"".concat(null!=c?c:"").concat(t)},[c]),[h,g]=(0,i.useState)(!1),[m,f]=(0,i.useState)(null),[w,v]=(0,i.useState)(null);return(0,i.useEffect)(()=>{let e=!0;g(!1),f(null);let t=new Image;return t.crossOrigin="anonymous",t.onload=()=>{e&&(v(t),f(null))},t.onerror=()=>{e&&(v(null),g(!1),f("초대장 이미지를 불러오지 못했습니다."))},(async()=>{var e;if(document.fonts&&"ready"in document.fonts)try{await document.fonts.ready}catch(e){}if(null===(e=document.fonts)||void 0===e?void 0:e.load)try{await Promise.all([document.fonts.load("700 36px rixdongnimgothic-pro"),document.fonts.load("700 36px 'rixdongnimgothic-pro'"),document.fonts.load("700 36px 'tk-rixdongnimgothic-pro'")])}catch(e){}})().finally(()=>{t.src=u(d)}),()=>{e=!1}},[u,d]),(0,i.useEffect)(()=>{let e=o.current,a=null==e?void 0:e.getContext("2d");if(!e||!a||!w)return;let i=()=>{let i=function(t,n){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.82,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:900,s=t.trim();if(!s)return;let d=Math.round(e.height*n),c=Math.min(.98*e.width,e.width*l),u=e=>{a.font="700 ".concat(e,"px ").concat(r);let t=a.measureText(s);return t.actualBoundingBoxRight-t.actualBoundingBoxLeft||t.width},h=48,g=Math.max(48,o),m=48;for(;h<=g;){let e=Math.floor((h+g)/2);u(e)<=c?(m=e,h=e+2):g=e-2}let f=Math.min(m,o);a.font="700 ".concat(f,"px ").concat(r),a.textAlign="center",a.textBaseline="middle",a.fillStyle="#121212";let w=e.width/2+i;a.fillText(s,w,d)};a.drawImage(w,0,0,e.width,e.height),i(n,.12431693989071038,-25,.94,900),i(t,.5628415300546448,50,.9,820)},l=null,s=()=>{let t=e.getBoundingClientRect(),n=Math.max(1,window.devicePixelRatio||1),l=Math.max(1024,Math.min(1024,Math.round((t.width||w.width)*n)||1024)),r=Math.max(1,Math.round(l*(w.naturalHeight&&w.naturalWidth?w.naturalHeight/w.naturalWidth:1.4296875)));(e.width!==l||e.height!==r)&&(e.width=l,e.height=r);let o=t.width||l/n,s=r/l*o;e.style.width="".concat(o,"px"),e.style.height="".concat(s,"px"),a.clearRect(0,0,e.width,e.height),i(),g(!0),f(null)};s();let d="undefined"!=typeof ResizeObserver?new ResizeObserver(()=>{l&&cancelAnimationFrame(l),l=window.requestAnimationFrame(s)}):null;null==d||d.observe(e);let c=()=>{l&&cancelAnimationFrame(l),l=window.requestAnimationFrame(s)};return window.addEventListener("resize",c),()=>{null==d||d.disconnect(),l&&cancelAnimationFrame(l),window.removeEventListener("resize",c)}},[o,t,n,w]),(0,a.jsxs)("div",{className:"invitation-wrapper",children:[!h&&(0,a.jsx)("div",{className:"canvas-status",children:null!=m?m:"초대장 이미지를 불러오는 중입니다..."}),(0,a.jsx)("canvas",{ref:o,className:null!=s?s:"invitation-canvas"})]})}},1854:function(e,t,n){"use strict";n.r(t);var a=n(5893),i=n(7294),l=n(1664),r=n.n(l),o=n(1163),s=n(1943),d=n(2588);t.default=()=>{let{basePath:e}=(0,o.useRouter)(),t=t=>{let n=t.startsWith("/")?t:"/".concat(t);return"".concat(null!=e?e:"").concat(n)},[n,l]=(0,i.useState)(!1),[c,u]=(0,i.useState)(""),[h,g]=(0,i.useState)(""),[m,f]=(0,i.useState)(!1),w=(0,i.useRef)(null),v=(0,i.useRef)(null),p=async()=>{var e;if(m)return;let t=w.current;if(!t){window.alert("초대장 미리보기가 준비되지 않았습니다.");return}let n=c.trim(),a=h.trim();if(0===t.width||0===t.height){window.alert("초대장 미리보기를 불러오는 중입니다. 잠시 후 다시 시도해 주세요.");return}let i=null!==(e=(0,d.u)(t))&&void 0!==e?e:t;f(!0);try{let e;if(!v.current)throw Error("다운로드 링크가 준비되지 않았습니다.");let t="invitation-from-".concat(encodeURIComponent(a||"unknown"),"-to-").concat(encodeURIComponent(n||"guest"),".png"),l=null,r=null;if(i.toBlob&&(l=await new Promise(e=>i.toBlob(e,"image/png"))),!l){let e=i.toDataURL("image/png");r=e;let t=e.indexOf(","),n=t>-1?e.slice(5,e.indexOf(";")):"image/png",a=atob(t>-1?e.slice(t+1):e),o=new ArrayBuffer(a.length),s=new Uint8Array(o);for(let e=0;e<a.length;e+=1)s[e]=a.charCodeAt(e);l=new Blob([s],{type:n})}if(!l)throw Error("초대장 이미지를 생성하지 못했습니다.");let o="undefined"!=typeof navigator?navigator:void 0,s="undefined"!=typeof navigator?navigator.userAgent:"",d=/iP(ad|hone|od)/i.test(s),c=d&&/Safari/i.test(s)&&!/CriOS|FxiOS|EdgiOS/i.test(s),u=!d&&/Safari/i.test(s)&&!/Chrome|CriOS|Edg|OPR/i.test(s),h={title:a?"".concat(a,"의 초대장"):"초대장",text:n?"".concat(n," 님께 전달하는 초대장입니다."):void 0};if("undefined"!=typeof File)try{h.files=[new File([l],t,{type:"image/png"})]}catch(e){}let g=!!(null==o?void 0:o.share),m=(()=>{if(!g||!o)return!1;if("function"!=typeof o.canShare)return!0;let e=h.files?{files:h.files}:{};try{return o.canShare(e)}catch(e){return!1}})(),f=r;if(!f){let t=URL.createObjectURL(l);f=t,e=()=>URL.revokeObjectURL(t)}let w=((e,n)=>{let a=v.current,i=(()=>{if("undefined"==typeof document)return!1;let e=document.createElement("a");return"download"in e})(),l="undefined"!=typeof navigator&&/iP(ad|hone|od)/i.test(navigator.userAgent);if(!l&&i&&a)return a.href=e,a.download=t,a.click(),a.removeAttribute("download"),a.removeAttribute("href"),null==n||n(),!0;let r=document.createElement("a");return r.href=e,r.download=t,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),n&&window.setTimeout(n,1500),!l})(f,e),p=!1;if(g&&m&&(c||u)&&(null==o?void 0:o.share))try{await o.share(h),p=!0}catch(e){console.warn("초대장 공유에 실패했습니다.",e)}if(!p&&!w&&d&&g&&m&&(null==o?void 0:o.share))try{await o.share(h)}catch(e){console.warn("초대장 공유에 실패했습니다.",e)}}catch(e){console.error(e),window.alert("초대장을 저장하지 못했습니다. 다시 시도해 주세요.")}finally{f(!1)}};return(0,a.jsx)("main",{className:"landing",children:(0,a.jsxs)("div",{className:"landing-wrapper",children:[(0,a.jsx)("img",{src:t("/invitation_2.svg"),alt:"졸업전시 초대장 미리보기 이미지",className:"landing-image-only"}),(0,a.jsx)("div",{className:"landing-overlay".concat(n?" landing-overlay--readonly":""),children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"landing-result-card","aria-live":"polite","aria-label":"완성된 초대장 미리보기",children:(0,a.jsx)(s.default,{from:h,to:c,canvasRef:w,className:"landing-result-canvas",imageSrc:"/invitation_2.svg"})}),(0,a.jsxs)("div",{className:"landing-result-actions",children:[(0,a.jsx)("button",{type:"button",className:"landing-result-action",onClick:p,disabled:m,"aria-label":m?"초대장 저장 중":"초대장 저장하기",children:(0,a.jsx)("img",{src:t("/save.svg"),alt:""})}),(0,a.jsx)("button",{type:"button",className:"landing-result-action landing-result-action--retry",onClick:()=>{f(!1),l(!1),u(""),g("")},"aria-label":"이름 다시 입력하기",children:(0,a.jsx)("img",{src:t("/retry.svg"),alt:""})})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("label",{className:"landing-field landing-field--to",htmlFor:"landing-to-input",children:[!c&&(0,a.jsx)("img",{src:t("/write.png"),alt:"",className:"landing-placeholder landing-placeholder--to"}),(0,a.jsx)("input",{id:"landing-to-input",className:"landing-input","aria-label":"초대장을 받는 분",maxLength:20,value:c,onChange:e=>u(e.target.value)})]}),(0,a.jsxs)("label",{className:"landing-field landing-field--from",htmlFor:"landing-from-input",children:[!h&&(0,a.jsx)("img",{src:t("/write.png"),alt:"",className:"landing-placeholder landing-placeholder--from"}),(0,a.jsx)("input",{id:"landing-from-input",className:"landing-input","aria-label":"초대장을 보내는 분",maxLength:20,value:h,onChange:e=>g(e.target.value)})]})]})}),!n&&(0,a.jsx)(r(),{href:"/generator",className:"landing-button",prefetch:!1,"aria-label":"초대장 만들기 페이지로 이동",onClick:e=>{n||(e.preventDefault(),l(!0))},children:(0,a.jsx)("img",{src:t("/button_1.svg"),alt:"초대장 만들기 이동 버튼"})}),(0,a.jsx)("a",{ref:v,style:{display:"none"},"aria-hidden":"true"})]})})}}},function(e){e.O(0,[424,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);